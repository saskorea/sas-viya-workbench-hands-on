[{"kind":1,"language":"markdown","value":"# V. 모형 학습","outputs":[{"items":[{"data":"[\n\t{\n\t\t\"line\": \"264  /** LOG_START_INDICATOR **/\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"265  title;footnote;ods _all_ close;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"266  ods graphics on;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"267  ods html5(id=vscode) style=HTMLEncore options(bitmap_mode='inline' svg_mode='inline');\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"NOTE: Writing HTML5(VSCODE) Body file: sashtml14.htm\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"268  %let _SASPROGRAMFILE = %nrquote(%nrstr(Untitled-1.sasnb));\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"269  # V. 모형 학습\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"     -\",\n\t\t\"type\": \"error\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"     180\",\n\t\t\"type\": \"error\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"ERROR 180-322: Statement is not valid or it is used out of proper order.\",\n\t\t\"type\": \"error\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"270  ;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"270!  *';*\\\";*/;run;quit;ods html5(id=vscode) close;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"271  \",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t}\n]","mime":"application/vnd.sas.compute.log.lines"}]}]},{"kind":1,"language":"markdown","value":"## 1. 사전 작업","outputs":[]},{"kind":1,"language":"markdown","value":"### 1) 라이브러리 할당","outputs":[]},{"kind":2,"language":"sas","value":"libname WRKLIB \"sas-viya-workbench-hands-on/02. SAS 데이터\";","outputs":[]},{"kind":1,"language":"markdown","value":"### 2) 사용자 정의 format 할당","outputs":[]},{"kind":2,"language":"sas","value":"proc format cntlin = WRKLIB.hrd_code; run;","outputs":[]},{"kind":1,"language":"markdown","value":"### 3) 메타 정보 추출","outputs":[]},{"kind":2,"language":"sas","value":"%let IC_VARS =; \n%let IN_VARS =; \n%let TC_VARS =;\nproc sql noprint;\n    select variable into :IC_VARS separated by ' ' from WRKLIB.HRD_META where role = 'input' and type = 'char'; /* 문자형 입력 변수 */\n    select variable into :IN_VARS separated by ' ' from WRKLIB.HRD_META where role = 'input' and type = 'num';  /* 숫자형 입력 변수 */\n    select variable into :TC_VARS separated by ' ' from WRKLIB.HRD_META where role = 'target';                  /* 타겟 변수 */\nquit;\n%put NOTE: &=IC_VARS &=IN_VARS &=TC_VARS;","outputs":[{"items":[{"data":"[\n\t{\n\t\t\"line\": \"272  /** LOG_START_INDICATOR **/\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"273  title;footnote;ods _all_ close;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"274  ods graphics on;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"275  ods html5(id=vscode) style=HTMLEncore options(bitmap_mode='inline' svg_mode='inline');\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"NOTE: Writing HTML5(VSCODE) Body file: sashtml15.htm\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"276  %let _SASPROGRAMFILE = %nrquote(%nrstr(Untitled-1.sasnb));\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"277  %let IC_VARS =;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"278  %let IN_VARS =;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"279  %let TC_VARS =;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"280  proc sql noprint;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"281      select variable into :IC_VARS separated by ' ' from WRKLIB.HRD_META where role = 'input' and type = 'char';\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"281!                                                                                                                 /* 문자형\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"281! 입력 변수 */\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"282      select variable into :IN_VARS separated by ' ' from WRKLIB.HRD_META where role = 'input' and type = 'num';\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"282!                                                                                                                 /* 숫자형\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"282! 입력 변수 */\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"283      select variable into :TC_VARS separated by ' ' from WRKLIB.HRD_META where role = 'target';\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"283!                                                                                                                 /* 타겟\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"283! 변수 */\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"284  quit;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"NOTE: PROCEDURE SQL used (Total process time):\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"      real time           0.00 seconds\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"      cpu time            0.00 seconds\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"      \",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"285  %put NOTE: &=IC_VARS &=IN_VARS &=TC_VARS;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"NOTE: IC_VARS=SEX MAR_ST_CD RACE_CD STAT_CD POSIT_CD DEPT_ID MNGR_ID KPI_CD CTZ_CD RCRT_CD IN_VARS=AGE SAL_AM TNR_DD ENG_SCR \",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"SAT_SCR PRJ_CN LT_DD ABSN TC_VARS=TRMD_YN\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"286  ;*';*\\\";*/;run;quit;ods html5(id=vscode) close;\",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"287  \",\n\t\t\"type\": \"source\",\n\t\t\"version\": 1\n\t},\n\t{\n\t\t\"line\": \"\",\n\t\t\"type\": \"note\",\n\t\t\"version\": 1\n\t}\n]","mime":"application/vnd.sas.compute.log.lines"}]}]},{"kind":1,"language":"markdown","value":"## 2. 모형 적합","outputs":[]},{"kind":1,"language":"markdown","value":"### 1) 의사결정나무","outputs":[]},{"kind":2,"language":"sas","value":"proc treesplit data = WRKLIB.HRD_DATA_PARTED;\n    input  &IN_VARS / level = interval;\n    input  &IC_VARS / level = nominal;\n    target &TC_VARS / level = nominal;\n    partition rolevar = _PartInd_ (train = '0' valid = '1' test = '2');\n    format &TC_VARS best8.;\n    output out = WRKLIB.HRD_DATA_DTR\n        copyvars = ( EMP_ID &TC_VARS. _PartInd_ );\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"### 2) 랜덤포레스트","outputs":[]},{"kind":2,"language":"sas","value":"proc forest data = WRKLIB.HRD_DATA_PARTED;\n    input  &IN_VARS / level = interval;\n    input  &IC_VARS / level = nominal;\n    target &TC_VARS / level = nominal;\n    partition rolevar = _PartInd_ (train = '0' valid = '1' test = '2');\n    format &TC_VARS best8.;\n    output out = WRKLIB.HRD_DATA_RFM\n        copyvars = ( EMP_ID &TC_VARS. _PartInd_ );\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"### 3) 그레디언트부스팅","outputs":[]},{"kind":2,"language":"sas","value":"proc gradboost data = WRKLIB.HRD_DATA_PARTED;\n    input  &IN_VARS / level = interval;\n    input  &IC_VARS / level = nominal;\n    target &TC_VARS / level = nominal;\n    partition rolevar = _PartInd_ (train = '0' valid = '1' test = '2');\n    format &TC_VARS best8.;\n    output out = WRKLIB.HRD_DATA_GBM\n        copyvars = ( EMP_ID &TC_VARS. _PartInd_ );\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"### 3) 라이트GBM","outputs":[]},{"kind":2,"language":"sas","value":"data train_data\n     valid_data;\n    set WRKLIB.HRD_DATA_PARTED;\n    format &TC_VARS best8.;\n    select (_PartInd_);\n        when ('0') output train_data;\n        when ('1') output valid_data;\n        otherwise;\n    end;\nrun;\nproc lightgradboost data      = train_data\n                    validData = valid_data\n    ;\n    input  &IN_VARS / level = interval;\n    input  &IC_VARS / level = nominal;\n    target &TC_VARS / level = nominal;\n    saveState rstore = WRKLIB.HRD_DATA_LGB_MODEL;  /* 스코어링 테이블 */\nrun;\nproc astore;\n    score \n        rstore   = WRKLIB.HRD_DATA_LGB_MODEL\n        data     = WRKLIB.HRD_DATA_PARTED\n        out      = WRKLIB.HRD_DATA_LGB        \n        copyVars = (  EMP_ID &TC_VARS. _PartInd_ )\n    ;\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"### 4) 로지스틱 회귀","outputs":[]},{"kind":2,"language":"sas","value":"proc logselect data = WRKLIB.HRD_DATA_BIN;\n    class &IC_VARS &TC_VARS;\n    model &TC_VARS = &IN_VARS &IC_VARS / noint;\n    partition rolevar = _PartInd_ (train = '0' valid = '1' test = '2');\n    selection method = stepwise;\n    format &TC_VARS best8.;\n    output \n        out      = _temp_pred_log_\n        copyVars = (  EMP_ID &TC_VARS. _PartInd_ )\n    ;\nrun;\ndata WRKLIB.HRD_DATA_LOG;\n    set _temp_pred_log_;\n    p_&TC_VARS.1 = _pred_;\n    p_&TC_VARS.0 = 1- _pred_;\n    drop _pred_;\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"### 5) 서포트벡터머신","outputs":[]},{"kind":2,"language":"sas","value":"proc svmachine data   = WRKLIB.HRD_DATA_BIN;\n    input  &IN_VARS / level = interval;\n    input  &IC_VARS / level = nominal;\n    target &TC_VARS / level = nominal;\n    partition rolevar = _PartInd_ (train = '0' valid = '1' test = '2');\n    format &TC_VARS best8.;\n    output \n        out = WRKLIB.HRD_DATA_SVM\n        copyVars = ( EMP_ID &TC_VARS. _PartInd_ )\n    ;\nrun;","outputs":[]}]